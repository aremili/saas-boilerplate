{# Single Task Item - Used by both list and HTMX responses #}
{% from "components/macros.html" import badge %}

<div id="task-{{ task.id }}" class="task-item">
    {# Checkbox - HTMX toggle using Shoelace #}
    <sl-checkbox {% if task.completed %}checked{% endif %} hx-patch="/tasks/{{ task.id }}/toggle"
        hx-target="#task-{{ task.id }}" hx-swap="outerHTML" hx-trigger="sl-change">
    </sl-checkbox>

    {# Task Content #}
    <div class="flex-1" style="min-width: 0;">
        <p class="{% if task.completed %}line-through text-muted{% endif %}" style="margin: 0;">
            {{ task.title }}
        </p>
        <p class="text-xs text-muted" style="margin: 0.25rem 0 0 0;">
            Priority: {{ task.priority }}
        </p>
    </div>

    {# Priority Badge #}
    {% set priority_colors = {1: "danger", 2: "warning", 3: "primary", 4: "neutral", 5: "neutral"} %}
    {% set priority_labels = {1: "Urgent", 2: "High", 3: "Medium", 4: "Low", 5: "Low"} %}
    {{ badge(priority_labels[task.priority], variant=priority_colors[task.priority]) }}

    {# Delete Button - HTMX delete #}
    <sl-icon-button name="trash" label="Delete task" class="delete-btn" hx-delete="/tasks/{{ task.id }}"
        hx-target="#task-{{ task.id }}" hx-swap="outerHTML" hx-confirm="Delete this task?">
    </sl-icon-button>
</div>